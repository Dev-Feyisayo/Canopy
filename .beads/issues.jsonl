{"id":"canopy-1yo","title":"Formalize IDL type system with explicit types","description":"Formalize the Canopy IDL type system with explicit type definitions, eliminating platform ambiguity.\n\nStatus: PLANNED - HIGH IMPACT FOUNDATIONAL WORK\n\nCurrent Problem:\n- Types like int, long, size_t have platform-dependent sizes\n- Poor type safety in generators (string-based type parsing)\n- Limited metaprogramming capabilities\n- Unclear RPC semantics (value vs handle types)\n\nProposed Solution:\n- Add explicit types: i8, i16, i32, i64, u8, u16, u32, u64, f32, f64\n- Add string, bytes collection types\n- Add vector\u003cT\u003e, array\u003cT,N\u003e, map\u003cK,V\u003e, optional\u003cT\u003e\n- Add shared_handle\u003cT\u003e, optimistic_handle\u003cT\u003e for RPC semantics\n\nImplementation Phases:\nPhase 1: AST Enhancement (2-3 weeks)\nPhase 2: Code Generator Updates (3-4 weeks)\nPhase 3: Migration and Compatibility (2-3 weeks)\nPhase 4: Validation and Tooling (2 weeks)\n\nReference: docs/to_do/IDL_Type_System_Formalization.md\nLocations: submodules/idlparser/, generator/src/","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":2400,"created_at":"2026-01-12T14:28:02.080870716Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:02.080870716Z","labels":["foundational","idl","parser","type-system"]}
{"id":"rpc-0bi","title":"Refactor service.cpp for better maintainability","description":"Refactor complex functions in service.cpp to improve maintainability and testability.\n\nStatus: PLANNED\n\nTarget Functions:\n1. check_is_empty() Decomposition\n   - Does too many things (logging, state verification, resource cleanup)\n   - Complex control flow with multiple responsibilities\n   - Hard to test in isolation\n   \n   Proposed:\n   - Extract logging logic\n   - Create dedicated state verification function\n   - Separate resource cleanup concerns\n\n2. release() Simplification\n   - Nested scopes with complex lock management\n   - Intricate logic for handling optimistic referencing\n   - Difficult to understand control flow\n   \n   Proposed:\n   - Extract optimistic reference handling\n   - Reduce nesting depth through early returns\n   - Document state transitions\n   - Create unit tests for each code path\n\nBenefits:\n- Easier to understand and maintain\n- Better testability\n- Reduced risk of bugs in complex logic\n\nReference: docs/to_do/CODE_QUALITY_REVIEW.md (Section 3.1)\nLocation: rpc/src/service.cpp","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":640,"created_at":"2026-01-12T14:28:36.366181836Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:36.366181836Z","labels":["code-quality","refactoring"]}
{"id":"rpc-1yo","title":"Formalize IDL type system with explicit types","description":"Formalize the RPC++ IDL type system with explicit type definitions, eliminating platform ambiguity.\n\nStatus: PLANNED - HIGH IMPACT FOUNDATIONAL WORK\n\nCurrent Problem:\n- Types like int, long, size_t have platform-dependent sizes\n- Poor type safety in generators (string-based type parsing)\n- Limited metaprogramming capabilities\n- Unclear RPC semantics (value vs handle types)\n\nProposed Solution:\n- Add explicit types: i8, i16, i32, i64, u8, u16, u32, u64, f32, f64\n- Add string, bytes collection types\n- Add vector\u003cT\u003e, array\u003cT,N\u003e, map\u003cK,V\u003e, optional\u003cT\u003e\n- Add shared_handle\u003cT\u003e, optimistic_handle\u003cT\u003e for RPC semantics\n\nImplementation Phases:\nPhase 1: AST Enhancement (2-3 weeks)\nPhase 2: Code Generator Updates (3-4 weeks)\nPhase 3: Migration and Compatibility (2-3 weeks)\nPhase 4: Validation and Tooling (2 weeks)\n\nReference: docs/to_do/IDL_Type_System_Formalization.md\nLocations: submodules/idlparser/, generator/src/","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":2400,"created_at":"2026-01-12T14:28:02.080870716Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:02.080870716Z","labels":["foundational","idl","parser","type-system"]}
{"id":"rpc-2ae","title":"Audit and implement unimplemented tests","description":"Audit tests from Master Implementation Plan and implement missing test cases.\n\nStatus: NEEDS AUDIT\n\nConfirmed Missing Tests:\n- zone_terminating notification (depends on transport_down)\n- Zone termination broadcast tests\n- Cascading failure tests\n- post() timing tests\n- Transport status management unit tests\n\nTests Needing Verification:\n- Add/remove destinations unit test\n- service_proxy refuses DISCONNECTED traffic\n- All transport status monitoring tests\n- Auto-delete on zero counts\n- Enforce symmetry on failure\n- Y-topology explicit tests\n- And more...\n\nTasks:\n1. Run test coverage analysis\n2. Map existing tests to plan specifications\n3. Implement missing unit tests\n4. Verify integration tests cover all scenarios\n\nReference: docs/to_do/Unimplemented_Tests.md\nDependencies: transport_down implementation, zone termination","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":480,"created_at":"2026-01-12T14:28:02.446966155Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:02.446966155Z","labels":["quality","testing"],"dependencies":[{"issue_id":"rpc-2ae","depends_on_id":"rpc-bq5","type":"blocks","created_at":"2026-01-12T14:29:35.246847073Z","created_by":"Edward Boggis-Rolfe"}]}
{"id":"rpc-3gk","title":"Complete optimistic pointer IDL integration","description":"Add rpc::optimistic_ptr support to IDL parser and comprehensive testing.\n\nStatus: PARTIALLY IMPLEMENTED - runtime exists, IDL parser support missing\n\nCurrent Status:\n- rpc::optimistic_ptr\u003cT\u003e class exists in C++ runtime\n- Some tests exist in post_functionality_test_suite.cpp\n- NOT supported in IDL parser - can't declare in .idl files\n\nImplementation Tasks:\nWeek 1: IDL Parser Support\n- Study how rpc::shared_ptr is parsed\n- Add optimistic_ptr recognition to lexer/parser\n- Update code generator for marshalling\n\nWeek 2: Runtime Integration\n- Enhance optimistic_ptr class (is_valid(), mark_released())\n- Object stub optimistic holder tracking\n- Object proxy handling\n\nWeek 3: Testing\n- Unit tests for all scenarios\n- Integration tests with multiple zones\n- Pass-through routing tests\n\nReference: docs/to_do/Optimistic_Pointer_Support.md\nLocations: rpc/include/rpc/internal/remote_pointer.h (lines 1878-2066), submodules/idlparser/","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":720,"created_at":"2026-01-12T14:28:01.824370083Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:01.824370083Z","labels":["idl","optimistic-pointers","parser"],"dependencies":[{"issue_id":"rpc-3gk","depends_on_id":"rpc-m4a","type":"blocks","created_at":"2026-01-12T14:29:35.223409453Z","created_by":"Edward Boggis-Rolfe"}]}
{"id":"rpc-498","title":"Verify concurrent transport access in service","description":"Location: /rpc/src/service.cpp\n\nIssue: transports_ map protected by zone_control mutex with complex operations. Race between transport creation, access, and removal.\n\nTask: Audit all access patterns, consider std::shared_ptr in map values.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.3","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":360,"created_at":"2026-01-12T14:41:32.537931144Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:32.537931144Z"}
{"id":"rpc-55n","title":"Complete WebSocket and REST transport implementation","description":"Complete WebSocket and REST transport implementations for web-based RPC integration.\n\nStatus: IN PROGRESS - basic implementations working, needs production hardening and full RPC integration\n\nWebSocket Transport (4-6 weeks):\n- Basic server/client with wslay ✓\n- Message framing and RPC serialization ✓\n- Bi-modal support (sync/async) - NEEDED\n- Reconnection and heartbeat - NEEDED\n- Testing and JavaScript client example - NEEDED\n\nREST Transport (3-4 weeks):\n- HTTP request handling with llhttp ✓\n- JSON serialization ✓\n- Automatic route generation from IDL - NEEDED\n- OpenAPI generation - NEEDED\n- Authentication and CORS - NEEDED\n\nQUIC Transport: NOT STARTED (future work)\n\nReference: docs/to_do/WebSocket_REST_QUIC_Transport.md\nLocations: transports/websocket/, transports/rest/","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":960,"created_at":"2026-01-12T14:28:01.940174734Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:01.940174734Z","labels":["networking","rest","transport","websocket"]}
{"id":"rpc-6gj","title":"Verify TCP transport send queue lock scope","description":"Location: /transports/tcp/transport.cpp:463\n\nIssue: Lock might be released during coroutine suspension points within processing loop.\n\nTask: Verify lock is held across entire queue processing. Document suspension point behavior.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.3","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":240,"created_at":"2026-01-12T14:41:31.847337997Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:31.847337997Z"}
{"id":"rpc-73g","title":"Create comprehensive pass_through test suite with test transport","description":"Progress: Created comprehensive test infrastructure with bimodal (blocking/coroutine) support following the inproc_setup pattern. Completed: 1) Mock test transport (transports/mock_test/) with call tracking and failure simulation, 2) passthrough_setup.h class with CoroSetUp/CoroTearDown/set_up/tear_down methods, 3) passthrough_test_v2.cpp with 13 bimodal tests covering happy and unhappy paths, 4) CMake integration with proper dependencies. Status: Tests compile successfully but encounter segfault during execution. Next: Debug runtime issue (likely scheduler/threading related), add remaining multithreaded/stress tests once basic tests are stable.","status":"closed","priority":1,"issue_type":"task","assignee":"Edward Boggis-Rolfe","owner":"edward@boggis-rolfe.com","created_at":"2026-01-12T18:16:28.005321498Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-17T20:24:40.838625643Z","closed_at":"2026-01-17T20:24:40.838625643Z","close_reason":"Closed","dependencies":[{"issue_id":"rpc-73g","depends_on_id":"rpc-kfw","type":"blocks","created_at":"2026-01-12T18:16:31.844506044Z","created_by":"Edward Boggis-Rolfe"}]}
{"id":"rpc-764","title":"Enhance static analysis with clang-tidy","description":"Enhance static analysis coverage with comprehensive clang-tidy configuration.\n\nStatus: PLANNED\n\nCurrent State:\n- Minimal .clang-tidy configuration\n- Limited static analysis coverage\n- No automated quality gates\n\nProposed Configuration:\n1. Enable bugprone-* checks for common programming errors\n2. Enable performance-* checks for optimization opportunities\n3. Enable modernize-* checks (selective) for C++20 idioms\n4. Enable cppcoreguidelines-* checks for best practices\n5. Configure appropriate severity levels and exclusions\n\nIntegration:\n- Add clang-tidy to CI pipeline\n- Set up pre-commit hooks (optional)\n- Create baseline for existing issues\n- Establish zero-new-issues policy\n\nBenefits:\n- Catch bugs earlier in development\n- Enforce coding standards\n- Improve code quality automatically\n\nReference: docs/to_do/CODE_QUALITY_REVIEW.md (Section 4.1)","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":320,"created_at":"2026-01-12T14:28:36.462041872Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:36.462041872Z","labels":["ci","quality","tooling"]}
{"id":"rpc-7i3","title":"Verify object proxy reference counting","description":"Location: /rpc/src/object_proxy.cpp\n\nIssue: shared_count_ and optimistic_count_ atomics in complex remote reference logic. Complex state machine involving local/remote operations may have races.\n\nTask: Review add_ref() and release() for proper sequencing. Verify state machine correctness.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.3","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":360,"created_at":"2026-01-12T14:41:32.191946533Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:32.191946533Z"}
{"id":"rpc-7t9","title":"Verify thread-local logger circular buffer","description":"Location: /rpc/src/thread_local_logger.cpp\n\nIssue: write_index_ atomic in circular buffer. Multiple threads could overwrite entries if not properly synchronized.\n\nTask: Verify buffer is thread-local OR has proper CAS operations.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.3","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":240,"created_at":"2026-01-12T14:41:32.429871872Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:32.429871872Z"}
{"id":"rpc-8eb","title":"Verify service proxy management in service","description":"Location: /rpc/src/service.cpp\n\nIssue: other_zones_ map protected by zone_control mutex. Similar to transport management - race between creation, access, removal.\n\nTask: Ensure consistent locking and reference counting.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.3","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":360,"created_at":"2026-01-12T14:41:32.64801954Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:32.64801954Z"}
{"id":"rpc-90a","title":"Fix TCP transport shutdown_event_ access","description":"Location: /transports/tcp/transport.cpp\n\nIssue: shutdown_event_ set from multiple places without clear synchronization.\n\nFix: Ensure atomic or mutex-protected access. Consider single shutdown coordination point.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.3","status":"open","priority":2,"issue_type":"bug","owner":"edward@boggis-rolfe.com","estimated_minutes":240,"created_at":"2026-01-12T14:41:31.963251524Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:31.963251524Z"}
{"id":"rpc-9ex","title":"Verify service proxy version negotiation","description":"Location: /rpc/src/service_proxy.cpp\n\nIssue: version_ atomic modified during version negotiation. Potential race during concurrent version negotiation attempts.\n\nTask: Ensure idempotent negotiation and use compare-and-swap where needed.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.3","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":240,"created_at":"2026-01-12T14:41:32.326977597Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:32.326977597Z"}
{"id":"rpc-bq5","title":"Implement transport failure detection and zone shutdown","description":"Implement transport_down() for failure notification and graceful shutdown via reference counting.\n\nStatus: DESIGNED BUT NOT PROPERLY HANDLED\n\nTwo scenarios to handle:\n1. Ungraceful Failure: transport_down() notification when transport fails\n2. Graceful Shutdown: Natural zone termination through reference counting (no notifications)\n\nKey Tasks:\n- Implement heartbeat mechanism for failure detection\n- Add transport_down() cascading cleanup\n- Implement reference count based cleanup\n- Handle parent-stays-alive logic for hierarchical transports\n- Proxy invalidation on failure\n- Pass-through cascade support\n\nReference: docs/to_do/Transport_Failure_And_Zone_Shutdown.md\nLocations: rpc/include/rpc/internal/marshaller.h (lines 177-181), rpc/include/rpc/internal/transport.h","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":1200,"created_at":"2026-01-12T14:28:01.590357329Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:01.590357329Z","labels":["core-rpc","reliability","transport"]}
{"id":"rpc-bv1","title":"Perform memory ordering audit for all atomics","description":"Phase 3 of thread safety work.\n\nTasks:\n1. Verify all atomic operations have appropriate memory ordering\n2. Document memory ordering choices with rationale\n3. Add static assertions or comments explaining ordering decisions\n4. Review relaxed ordering optimization opportunities (sequence numbers, IDs)\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.5 Phase 3\n\nDocumentation required for each atomic:\n- Why this memory ordering was chosen\n- What synchronizes-with relationships exist\n- References to C++ memory model guarantees","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":960,"created_at":"2026-01-12T14:41:45.386802939Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:45.386802939Z","dependencies":[{"issue_id":"rpc-bv1","depends_on_id":"rpc-o05","type":"blocks","created_at":"2026-01-12T14:41:58.515209178Z","created_by":"Edward Boggis-Rolfe"},{"issue_id":"rpc-bv1","depends_on_id":"rpc-g4h","type":"blocks","created_at":"2026-01-12T14:41:58.537845047Z","created_by":"Edward Boggis-Rolfe"},{"issue_id":"rpc-bv1","depends_on_id":"rpc-v5y","type":"blocks","created_at":"2026-01-12T14:41:58.559158913Z","created_by":"Edward Boggis-Rolfe"}]}
{"id":"rpc-d1v","title":"Audit and eliminate ambiguous raw pointer usage","description":"Audit and eliminate raw pointer usage to clarify ownership semantics.\n\nStatus: PLANNED\n\nCurrent Issues:\n- service::clean_up_on_failed_connection takes rpc::casting_interface* input_interface\n- service::get_object_id takes rpc::shared_ptr\u003ccasting_interface\u003e\u0026 ptr\n- Various other raw pointer usages throughout codebase\n\nGuidelines:\n- Use references (\u0026) for non-null observers\n- Use std::optional\u003cT*\u003e or nullable pointers for optional parameters\n- Ensure ownership is never transferred via raw pointers\n- Document ownership semantics in function contracts\n\nBenefits:\n- Clearer ownership semantics\n- Reduced risk of dangling pointers\n- Better static analysis results\n- More maintainable code\n\nReference: docs/to_do/CODE_QUALITY_REVIEW.md (Section 2.3)","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":480,"created_at":"2026-01-12T14:28:36.640736301Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:36.640736301Z","labels":["refactoring","safety"]}
{"id":"rpc-dzn","title":"Code generator modernization and refactoring","description":"Refactor monolithic code generator into maintainable, testable components.\n\nStatus: PLANNED - HIGH PRIORITY\n\nCurrent State:\n- generator/src/protobuf_generator.cpp is ~3000 lines\n- 'Stringly typed' C++ code generation approach\n- Monolithic structure makes maintenance difficult\n- Hard to add new features or modify existing output\n\nProposed Refactoring:\nPhase 1: Component Extraction (2 weeks)\n- Create TypeMapper class for type conversions\n- Create MessageGenerator class for message/struct generation\n- Create ServiceGenerator class for interface generation\n- Create CodeFormatter utility\n\nPhase 2: Template System Evaluation (1 week)\n- Evaluate template engines (Mustache, Jinja2-style, custom)\n- Proof-of-concept with selected engine\n\nPhase 3: Implementation (2-3 weeks)\n- Implement chosen approach\n- Migrate existing generation logic\n- Add comprehensive unit tests\n\nBenefits:\n- Easier to maintain and extend\n- Better separation of concerns\n- More testable code\n- Reduced risk of code generation bugs\n\nReference: docs/to_do/CODE_QUALITY_REVIEW.md (Section 3.2)\nLocations: generator/src/protobuf_generator.cpp, generator/src/synchronous_generator.cpp","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":1920,"created_at":"2026-01-12T14:28:02.680754265Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:02.680754265Z","labels":["architecture","code-generation","maintenance"]}
{"id":"rpc-f7o","title":"Implement DLL/Shared Object transport","description":"Implement bi-modal hierarchical transport for loading zones from shared libraries (DLLs/.so files).\n\nStatus: PLANNED - NOT YET STARTED\n\nRequirements:\n- Bi-modal support (synchronous and asynchronous modes)\n- Hierarchical architecture (parent-child, not peer-to-peer)\n- Direct function calls in sync mode, message queue in async mode\n- Scheduler options: shared or dedicated for DLL zone\n\nUse Cases:\n- Plugin architectures with hot-reloadable DLLs\n- Sandboxed extension zones in same process\n- Modular applications with dynamically loaded components\n\nImplementation Tasks (4-6 weeks):\nWeek 1-2: Design DLL transport interface and loading mechanism\nWeek 2-3: Implement synchronous mode\nWeek 3-4: Implement asynchronous mode\nWeek 5: Integration and testing\nWeek 6: Documentation and examples\n\nReference: docs/to_do/DLL_Shared_Object_Transport.md","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":1200,"created_at":"2026-01-12T14:28:02.198679756Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:02.198679756Z","labels":["dll","plugins","transport"]}
{"id":"rpc-ffw","title":"Complete post() testing and documentation","description":"Complete testing and documentation for post() fire-and-forget messaging.\n\nStatus: PARTIALLY IMPLEMENTED - implementation exists but needs comprehensive testing and non-coroutine considerations\n\nCurrent Issues:\n- Documentation may be incorrect - needs review\n- Non-coroutine behavior not fully tested\n- Comprehensive unit testing incomplete\n\nTasks:\n1. Fix documentation in marshaller.h\n2. Add non-coroutine tests\n3. Verify bi-modal behavior (sync and async modes)\n4. Add timing tests for async mode\n5. Document blocking behavior in sync mode\n6. Verify no-response handling\n\nReference: docs/to_do/Post_Function_Implementation_And_Testing.md\nLocation: rpc/include/rpc/internal/marshaller.h","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":480,"created_at":"2026-01-12T14:28:01.475166415Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:01.475166415Z","labels":["core-rpc","documentation","testing"],"dependencies":[{"issue_id":"rpc-ffw","depends_on_id":"rpc-73g","type":"blocks","created_at":"2026-01-12T18:16:31.865397865Z","created_by":"Edward Boggis-Rolfe"}]}
{"id":"rpc-g4h","title":"Fix pending transmits shutdown race","description":"Location: Both tcp_transport and spsc_transport\n\nIssue: pending_transmits_ map cleared during shutdown while requests might be completing. Race between pending request completion and map clearing.\n\nFix approach:\n1. Set shutdown flag atomically\n2. Drain pending requests with timeout\n3. Only then clear map\n4. Handle late completions gracefully\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.2","status":"open","priority":1,"issue_type":"bug","owner":"edward@boggis-rolfe.com","estimated_minutes":480,"created_at":"2026-01-12T14:41:31.514911554Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:31.514911554Z"}
{"id":"rpc-kfw","title":"Refactor pass_through to use template parameter for testability","description":"Refactor pass_through class to take a template parameter replacing the std::shared_ptr\u003cservice\u003e type for service_. This enables testing with mock services to validate all i_marshaller method activities without requiring full service infrastructure.","status":"closed","priority":1,"issue_type":"task","assignee":"Edward Boggis-Rolfe","owner":"edward@boggis-rolfe.com","created_at":"2026-01-12T18:16:20.50667097Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-17T20:24:37.861022348Z","closed_at":"2026-01-17T20:24:37.861022348Z","close_reason":"Closed"}
{"id":"rpc-m4a","title":"Verify and test object_released() implementation","description":"Verify and comprehensively test object_released() unidirectional notification system.\n\nStatus: IMPLEMENTED AND FUNCTIONAL - needs comprehensive testing and documentation\n\nImplementation Complete:\n- Zone tracking in object_stub (per-zone atomic counters)\n- Notification sending in service::release()\n- Transport routing (local, TCP, SPSC, pass-through)\n- Service event callback pattern\n\nNeeds Work:\n- Verify service_event handler usage in codebase\n- Comprehensive tests for notification flow\n- Multi-zone scenario tests\n- Pass-through routing tests\n- Documentation updates\n\nReference: docs/to_do/object_released_Method.md\nLocations: rpc/include/rpc/internal/marshaller.h (lines 168-174), rpc/src/service.cpp (lines 750-845)","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":240,"created_at":"2026-01-12T14:28:01.712052084Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:01.712052084Z","labels":["core-rpc","optimistic-pointers","testing"],"dependencies":[{"issue_id":"rpc-m4a","depends_on_id":"rpc-ffw","type":"blocks","created_at":"2026-01-12T14:29:35.200672664Z","created_by":"Edward Boggis-Rolfe"}]}
{"id":"rpc-o05","title":"Fix TCP Transport keep_alive_ shared pointer access","description":"Location: /transports/tcp/transport.cpp:463 - pump_messages() loop\n\nIssue: keep_alive_ shared_ptr accessed in loop condition without synchronization. Multiple coroutines might modify causing undefined behavior.\n\nFix options:\n1. Use std::atomic\u003cstd::shared_ptr\u003cT\u003e\u003e (C++20)\n2. Mutex-protected access\n3. Load once before loop and use local copy\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.2","status":"closed","priority":1,"issue_type":"bug","owner":"edward@boggis-rolfe.com","estimated_minutes":240,"created_at":"2026-01-12T14:41:31.397819265Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:59:50.470563953Z","closed_at":"2026-01-12T14:59:50.470563953Z","close_reason":"Fixed by adding internal synchronization to member_ptr class.\n\nImplementation:\n- Added std::shared_mutex to both stdex::member_ptr and rpc::member_ptr\n- get_nullable(): Uses std::shared_lock for concurrent read access\n- reset() and assignment operators: Use std::unique_lock for exclusive write access\n- Copy/move assignment: Use std::scoped_lock to prevent deadlock when locking both mutexes\n\nThread-Safety Guarantees:\n- Multiple threads can call get_nullable() concurrently (reader-writer lock)\n- Writes (reset, assignment) have exclusive access and block all reads\n- No external synchronization required - member_ptr handles it internally\n\nDesign Philosophy:\nmember_ptr forces threads to extract a local copy via get_nullable(), which prevents race conditions on the member variable itself. The internal shared_mutex ensures thread-safe access to the underlying shared_ptr, while the shared_ptr's reference counting provides thread-safe lifetime management.\n\nFiles Modified:\n- rpc/include/rpc/internal/member_ptr.h\n\nDocumentation:\n- Added comprehensive Doxygen comments explaining thread-safety guarantees\n- Included usage examples for both stdex::member_ptr and rpc::member_ptr\n- Documented the design rationale"}
{"id":"rpc-o0u","title":"Address thread safety and race conditions","description":"DECOMPOSED into specific issues - see below.\n\nThis epic has been broken down into 14 actionable issues:\n\nHIGH Priority Fixes (P1):\n- rpc-o05: Fix TCP Transport keep_alive_ shared pointer access\n- rpc-g4h: Fix pending transmits shutdown race\n- rpc-v5y: Fix service proxy map operation races\n\nMEDIUM Priority Verifications (P2):\n- rpc-o35: Review transport destination management performance\n- rpc-6gj: Verify TCP transport send queue lock scope\n- rpc-90a: Fix TCP transport shutdown_event_ access\n- rpc-qcp: Verify SPSC transport send queue lock scope\n- rpc-7i3: Verify object proxy reference counting\n- rpc-9ex: Verify service proxy version negotiation\n- rpc-7t9: Verify thread-local logger circular buffer\n- rpc-498: Verify concurrent transport access in service\n- rpc-8eb: Verify service proxy management in service\n\nAudit \u0026 Testing (P1):\n- rpc-bv1: Perform memory ordering audit for all atomics (depends on HIGH fixes)\n- rpc-o9y: ThreadSanitizer testing and stress tests (depends on audit)\n\nReference: docs/to_do/CODE_QUALITY_REVIEW.md Section 2.1","status":"closed","priority":0,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":960,"created_at":"2026-01-12T14:28:02.561091421Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:42:32.436037249Z","closed_at":"2026-01-12T14:42:32.436037249Z","close_reason":"Decomposed into 14 specific actionable issues for better tracking and parallel work","labels":["concurrency","critical","safety"]}
{"id":"rpc-o35","title":"Review transport destination management performance","description":"Location: /rpc/src/transport.cpp:249-298 - create_pass_through()\n\nStatus: Deadlock prevention already implemented via consistent lock ordering (zone ID order).\n\nTask: Performance review of coarse-grained locking on nested map pass_thoughs_. Consider finer-grained locking if profiling shows contention.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.2","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":240,"created_at":"2026-01-12T14:41:31.620015815Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:31.620015815Z"}
{"id":"rpc-o9y","title":"ThreadSanitizer testing and stress tests","description":"Phase 4 of thread safety work - comprehensive testing with race detection tools.\n\nTasks:\n1. Build with ThreadSanitizer: cmake --preset Debug -DCMAKE_CXX_FLAGS=\"-fsanitize=thread -g\"\n2. Run all tests under ThreadSanitizer\n3. Run Helgrind (valgrind --tool=helgrind) for additional verification\n4. Create stress tests with 100+ concurrent zones\n5. Test rapid connection/disconnection cycles\n6. Test simultaneous shutdown from multiple threads\n7. Fix any races discovered during testing\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.6\n\nSuccess criteria:\n- Zero TSan violations\n- Zero Helgrind violations\n- Stress tests pass consistently","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":1920,"created_at":"2026-01-12T14:41:45.504991505Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:45.504991505Z","dependencies":[{"issue_id":"rpc-o9y","depends_on_id":"rpc-bv1","type":"blocks","created_at":"2026-01-12T14:41:58.628019435Z","created_by":"Edward Boggis-Rolfe"}]}
{"id":"rpc-qcp","title":"Verify SPSC transport send queue lock scope","description":"Location: /transports/spsc/transport.cpp\n\nIssue: Similar to TCP - lock acquired, released, queue accessed again.\n\nTask: Ensure atomic queue operations or proper lock scope throughout.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.3","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":240,"created_at":"2026-01-12T14:41:32.070969221Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:32.070969221Z"}
{"id":"rpc-rjt","title":"Enhance SGX enclave transport with bi-modal support","description":"Implement bi-modal hierarchical transport for secure enclave zones (SGX, TrustZone).\n\nStatus: PLANNED - ENHANCEMENT TO EXISTING SGX TRANSPORT\n\nCurrent State:\n- Existing SGX transport likely synchronous-only\n- Needs enhancement for full bi-modal support\n- Needs better integration with transport base class\n\nRequirements:\n- Bi-modal support (synchronous and asynchronous modes)\n- Synchronous: Blocking ECALL/OCALL semantics\n- Asynchronous: Async ECALL/OCALL with coroutine suspension\n- Scheduler options: shared or dedicated (dedicated recommended for security)\n- Hierarchical architecture (untrusted ↔ enclave)\n\nSecurity Considerations:\n- All data crossing enclave boundary must be serialized\n- No raw pointer passing across boundary\n- Careful scheduler state management (trust boundary)\n\nImplementation Tasks (6-8 weeks):\nWeek 1-2: Analyze current SGX transport\nWeek 3-4: Implement bi-modal ECALL/OCALL\nWeek 4-5: Scheduler integration\nWeek 5-6: Multi-level hierarchy support\nWeek 7: ARM TrustZone support (optional)\nWeek 8: Documentation and security review\n\nReference: docs/to_do/Enhanced_Enclave_Transport.md\nDependencies: DLL transport (for similar pattern reference)","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":1600,"created_at":"2026-01-12T14:28:02.329530429Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:02.329530429Z","labels":["enclave","security","sgx","transport"],"dependencies":[{"issue_id":"rpc-rjt","depends_on_id":"rpc-f7o","type":"blocks","created_at":"2026-01-12T14:29:35.269431374Z","created_by":"Edward Boggis-Rolfe"}]}
{"id":"rpc-v5y","title":"Fix service proxy map operation races","description":"Location: /rpc/src/service_proxy.cpp\n\nIssue: proxies_ map operations in on_object_proxy_released() and get_or_create_object_proxy() may have races between creation, release, and cleanup.\n\nFix: Ensure consistent locking pattern (lock → check → operate → unlock). Avoid unlocking and re-locking within single logical operation.\n\nReference: CODE_QUALITY_REVIEW.md Section 2.1.2","status":"open","priority":1,"issue_type":"bug","owner":"edward@boggis-rolfe.com","estimated_minutes":360,"created_at":"2026-01-12T14:41:31.721557621Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:41:31.721557621Z"}
{"id":"rpc-v64","title":"Add comprehensive public API documentation","description":"Add comprehensive Doxygen-style API documentation for all public headers.\n\nStatus: PLANNED\n\nCurrent State: Sparse comments in public headers\n\nTarget Files:\n- rpc/include/rpc/rpc.h - Main public API\n- rpc/include/rpc/internal/service.h - Service interface\n- rpc/include/rpc/internal/marshaller.h - Marshalling interface\n- All other public headers\n\nRequired Documentation:\n- Function purpose and behavior\n- Parameter descriptions\n- Return value semantics\n- Thread-safety guarantees\n- Exception specifications\n- Usage examples\n- Pre/post-conditions\n\nBenefits:\n- Easier for developers to use the library\n- Better understanding of API contracts\n- Foundation for auto-generated documentation\n\nReference: docs/to_do/CODE_QUALITY_REVIEW.md (Section 5.1)","status":"open","priority":2,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":640,"created_at":"2026-01-12T14:28:36.550506377Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:36.550506377Z","labels":["api","documentation"]}
{"id":"rpc-y7n","title":"transport::inbound_add_ref Reference Counting Bug","description":"## Issue: transport::inbound_add_ref Reference Counting Bug\n\n### Problem\nThe transport::inbound_add_ref method has a bug where it doesn't properly increment transport reference counts or notify passthrough, causing incorrect internal state tracking.\n\n### Root Cause Analysis\n1. Same-zone operations: When forward_transport-\u003einbound_add_ref() is called with forward_dest (same zone), the transport's add_ref_count should increment but doesn't\n2. Passthrough notification failure: Passthrough's add_ref method isn't being called when it should be for cross-zone operations\n3. Complex reference counting rules: Missing logic for different add_ref_options scenarios\n\n### Reference Counting Rules Found\n- If caller_or_destination == service_zone_id: Increment add_ref_count (local service-to-transport)\n- If add_ref_options::normal OR add_ref_options::optimistic: Increment add_ref_count AND notify passthrough\n- If build_caller_route XOR build_dest_channel: Increment add_ref_count AND notify passthrough  \n- If build_caller_route \u0026\u0026 build_destination_route: Do NOT increment reference counts (back-channel only)\n\n### Release Counting Rules (Simpler)\n- All releases go through passthrough if not involving local service\n- No transformation of routing context\n\n### Race Condition Warning\nThere's a potential race condition when two threads add the same source/destination pair - needs synchronization protection.\n\n### Fix Plan\n1. Implement correct reference counting logic in transport::inbound_add_ref\n2. Add proper passthrough notification with synchronization\n3. Apply same logic to transport::inbound_release\n4. Handle edge cases and race conditions\n\n### Affected Tests\n- add_ref_optimistic - expecting add_ref_count to be 1, getting 0\n- release_happy_path - expecting release_count to be 1, getting 0  \n- reference_count_balance - expecting send_count to be 2, getting 0\n\nPlease track this issue as high priority for transport layer fixes.","status":"closed","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","created_at":"2026-01-12T23:11:44.832234875Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-17T20:25:17.614839213Z","closed_at":"2026-01-17T20:25:17.614839213Z","close_reason":"Closed"}
{"id":"rpc-zw9","title":"Document and mitigate deadlock risks","description":"Eliminate deadlock risks through architectural improvements and documentation.\n\nStatus: PLANNED - Partially addressed in thread safety analysis\n\nCurrent State:\n- service.cpp contains explicit warnings about deadlock risks\n- Uses scoped blocks to manage lock lifetimes (fragile approach)\n- Complex interactions between stub_control_ and zone_control_ mutexes\n- Transport destination management already implements deadlock prevention via lock ordering\n\nProposed Actions:\n1. Review and document all mutex acquisition patterns\n2. Analyze stub_control_ and zone_control_ lock interactions\n3. Consider lock hierarchy to prevent circular dependencies\n4. Evaluate alternative concurrency models (e.g., actor model for internal state management)\n5. Reduce scope of critical sections where possible\n6. Document lock ordering policies\n\nRisk Assessment: High priority due to potential runtime failures\n\nBenefits:\n- Prevent runtime deadlocks\n- More maintainable concurrent code\n- Better understanding of concurrency patterns\n\nReference: docs/to_do/CODE_QUALITY_REVIEW.md (Section 2.2)\nRelated: rpc-o0u (thread safety and race conditions)","status":"open","priority":1,"issue_type":"task","owner":"edward@boggis-rolfe.com","estimated_minutes":960,"created_at":"2026-01-12T14:28:36.746667761Z","created_by":"Edward Boggis-Rolfe","updated_at":"2026-01-12T14:28:36.746667761Z","labels":["architecture","concurrency","safety"],"dependencies":[{"issue_id":"rpc-zw9","depends_on_id":"rpc-o0u","type":"blocks","created_at":"2026-01-12T14:29:35.29221463Z","created_by":"Edward Boggis-Rolfe"}]}
